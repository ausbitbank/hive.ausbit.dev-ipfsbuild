(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"93d1":function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-page",{staticClass:"flex q-pa-md flex-center"},[r("q-card",[r("q-card-section",{staticClass:"text-h5 text-center"},[t._v("\n      Decentralized Hive Fund\n    ")]),r("q-card-section",[void 0!==t.daoAccount?r("q-list",[r("q-item",[r("q-item-section",[t._v("\n            Maximum Daily Budget "),r("q-badge",{attrs:{color:"primary"}},[t._v(t._s(t.tidyNumber(parseInt(t.daoAccount.hbd_balance.split(" ")[0])/10))+" HBD")])],1),r("q-item-section",[t._v("\n            Total Budget "),r("q-badge",{attrs:{color:"primary"}},[t._v(t._s(t.tidyNumber(t.daoAccount.hbd_balance)))])],1)],1)],1):t._e()],1),r("q-card-section",{staticClass:"text-center"},[r("q-checkbox",{attrs:{label:"Hide Expired"},model:{value:t.filterExpired,callback:function(e){t.filterExpired=e},expression:"filterExpired"}}),r("q-checkbox",{attrs:{label:"Hide Funded"},model:{value:t.filterFunded,callback:function(e){t.filterFunded=e},expression:"filterFunded"}}),r("q-checkbox",{attrs:{label:"Hide Unfunded"},model:{value:t.filterUnfunded,callback:function(e){t.filterUnfunded=e},expression:"filterUnfunded"}}),r("q-checkbox",{attrs:{label:"Hide Active"},model:{value:t.filterActive,callback:function(e){t.filterActive=e},expression:"filterActive"}}),r("br"),t.loggedInUser?r("q-checkbox",{attrs:{label:"Hide Already Voted"},model:{value:t.filterVoted,callback:function(e){t.filterVoted=e},expression:"filterVoted"}}):t._e(),r("br"),r("div",{staticClass:"text-center"},[t._v(t._s(t.filteredProposals.length)+" proposals displayed, "+t._s(t.proposals.length)+" loaded")]),r("div",{staticClass:"text-center"},[t._v("Votes needed for funding: ~"+t._s(t.tidyNumber((t.vestToHive(t.returnProposalVotes)/1e6).toFixed()))+" HP")])],1),r("q-card-section",{staticClass:"text-center q-gutter-y-md"},[r("div",{staticStyle:{"text-align":"center"}},[r("q-input",{attrs:{label:"Search proposals"},scopedSlots:t._u([t.search?{key:"append",fn:function(){return[r("q-icon",{staticClass:"cursor-pointer",attrs:{name:"cancel"},on:{click:function(e){e.stopPropagation(),t.search=""}}})]},proxy:!0}:null],null,!0),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]),r("q-card-section",[r("q-list",{attrs:{bordered:"",separator:""}},t._l(t.filteredProposals,(function(e){return r("q-item",{key:e.index},[r("proposal",{attrs:{p:e,returnProposalVotes:t.returnProposalVotes}})],1)})),1),t._e()],1)],1)],1)},a=[],o=(r("7f7f"),r("6762"),r("2fdb"),r("7514"),r("a481"),r("6b54"),r("06db"),r("28a5"),r("386d"),r("c1df")),i=r.n(o),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-list",{attrs:{dense:""}},[r("q-item",{staticClass:"text-h6"},[r("router-link",{attrs:{to:t.returnPostLink(t.p.creator,t.p.permlink)}},[t._v(t._s(t.p.subject))]),r("span",{staticClass:"text-grey text-caption"},[t._v(t._s(t.p.id))])],1),r("q-item",[r("q-item-section",{attrs:{avatar:""}},[r("q-avatar",{attrs:{size:"sm"}},[r("q-img",{attrs:{src:t.getHiveAvatarUrl(t.p.creator)}})],1)],1),r("q-item-section",{staticClass:"q-ma-sm"},[t._v("\n      Creator: "),r("router-link",{attrs:{to:t.returnUserLink(t.p.creator)}},[t._v(t._s(t.p.creator))])],1),t.p.creator!==t.p.receiver?r("q-item-section",{attrs:{avatar:""}},[r("q-avatar",{attrs:{size:"sm"}},[r("q-img",{attrs:{src:t.getHiveAvatarUrl(t.p.receiver)}})],1)],1):t._e(),t.p.creator!==t.p.receiver?r("q-item-section",{staticClass:"q-ma-sm"},[t._v("\n      Receiver: "),r("router-link",{attrs:{to:t.returnUserLink(t.p.receiver)}},[t._v(t._s(t.p.receiver))])],1):t._e()],1),r("q-item",[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{name:"date_range",color:"grey"}})],1),r("q-item-section",[t._v("\n      "+t._s(t.returnNiceDate(t.p.start_date))+" - "+t._s(t.returnNiceDate(t.p.end_date))+"\n    ")])],1),r("q-item",[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{name:"monetization_on",color:"green"}})],1),t.p.daily_pay?r("q-item-section",[t._v("\n      Daily Pay: "+t._s(t.tidyNumber(t.p.daily_pay.amount/1e3))+" HBD\n    ")]):t._e()],1),r("q-item",[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{name:"favorite",color:"red"}})],1),r("q-item-section",[t._v("\n      Vote Value: "+t._s(t.tidyNumber((t.vestToHive(t.p.total_votes)/1e6).toFixed()))+" HP\n    ")])],1),r("q-item",[r("q-item-section",{attrs:{avatar:""}},[0===t.p.id?r("q-icon",{attrs:{name:"star",color:"orange",title:"return p"}}):"active"===t.p.status&&parseInt(t.p.total_votes)<t.returnProposalVotes?r("q-icon",{attrs:{name:"circle",color:"orange",title:"active, unfunded"}}):"active"===t.p.status?r("q-icon",{attrs:{name:"circle",color:"green",title:"active, funded"}}):"expired"===t.p.status?r("q-icon",{attrs:{name:"cancel",color:"grey",title:"expired"}}):"inactive"===t.p.status?r("q-icon",{attrs:{name:"circle",color:"red",title:"inactive"}}):t._e()],1),r("q-item-section",[t._v("\n      Status:\n      "),"active"===t.p.status&&parseInt(t.p.total_votes)<t.returnProposalVotes?r("span",[t._v("Active, Unfunded")]):"active"===t.p.status?r("span",[t._v("Active, Funded")]):"expired"===t.p.status?r("span",[t._v("Expired")]):"inactive"===t.p.status?r("span",[t._v("Inactive")]):r("span",[t._v(t._s(t.p.status))])])],1),t.p.voted?r("q-item",[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{name:"check",color:"green"}})],1),r("q-item-section",[t._v("\n      Voted by "+t._s(t.loggedInUser)+" "),r("a",{attrs:{href:t.returnHiveSignerDeny(t.p.id),target:"blank"}},[t._v("Unvote")])])],1):r("q-item",[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{name:"check_box_outline_blank"}})],1),r("q-item-section",[r("a",{attrs:{href:t.returnHiveSignerApprove(t.p.id),target:"_blank"}},[t._v("Vote for proposal")])])],1)],1)},c=[],l={name:"proposal",data:function(){return{votes:null}},props:["p","returnProposalVotes"],computed:{loggedInUser:function(){return this.$store.state.hive.user.username},globalProps:function(){return this.$store.state.hive.globalProps}},methods:{returnPostLink:function(t,e){return"/@"+t+"/"+e},returnUserLink:function(t){return"/@"+t},getHiveAvatarUrl:function(t){return"https://images.hive.blog/u/"+t+"/avatar"},returnNiceDate:function(t){return i()(t).format("Do MMMM YYYY")},returnHiveSignerApprove:function(t){return"https://hivesigner.com/sign/update-proposal-votes?proposal_ids=%5B"+t+"%5D&approve=true"},returnHiveSignerDeny:function(t){return"https://hivesigner.com/sign/update-proposal-votes?proposal_ids=%5B"+t+"%5D&approve=false"},vestToHive:function(t){return this.globalProps?this.$hive.formatter.vestToHive(t,this.globalProps.total_vesting_shares,this.globalProps.total_vesting_fund_hive):null},tidyNumber:function(t){if(t){var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")}return null}},mounted:function(){}},u=l,p=r("2877"),d=r("1c1c"),v=r("66e5"),f=r("4074"),h=r("cb32"),m=r("068f"),_=r("0016"),g=r("eebe"),b=r.n(g),q=Object(p["a"])(u,n,c,!1,null,null,null),x=q.exports;b()(q,"components",{QList:d["a"],QItem:v["a"],QItemSection:f["a"],QAvatar:h["a"],QImg:m["a"],QIcon:_["a"]});var y={name:"Proposals",components:{proposal:x},data:function(){return{proposals:[],filterExpired:!0,filterFunded:!1,filterUnfunded:!1,filterActive:!1,filterVoted:!1,search:this.$route.query.search||"",votes:null}},methods:{getAccount:function(t){void 0===this.$store.state.hive.accounts[t]&&this.$store.dispatch("hive/getAccount",t)},listProposals:function(){var t=this,e=[-1];this.proposals.length>0&&(e=[this.proposals[this.proposals.length-10].proposal_id]);var r={limit:200,order:"by_total_votes",order_direction:"descending",start:e};this.$hive.api.callAsync("database_api.list_proposals",r).then((function(e){t.proposals.length>0?t.proposals.concat(e.proposals):t.proposals=e.proposals,t.loggedInUser&&t.getUserVotes()}))},tidyNumber:function(t){if(t){var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")}return null},timeDelta:function(t){var e=i.a.utc(),r=i.a.utc(t),s=r.diff(e,"minutes");return i.a.duration(s,"minutes").humanize(!0)},vestToHive:function(t){return this.globalProps?this.$hive.formatter.vestToHive(t,this.globalProps.total_vesting_shares,this.globalProps.total_vesting_fund_hive):null},getUserVotes:function(){var t=this,e={limit:100,order:"by_voter_proposal",order_direction:"ascending",start:[this.loggedInUser]};this.$hive.api.callAsync("database_api.list_proposal_votes",e).then((function(e){t.votes=e.proposal_votes,t.votes.forEach((function(e){if(e.voter===t.loggedInUser){var r=t.proposals.find((function(t){return t.id===e.proposal.id}));r&&(r.voted=!0)}}))}))}},computed:{loggedInUser:function(){return this.$store.state.hive.user.username},globalProps:function(){return this.$store.state.hive.globalProps},daoAccount:{cache:!1,get:function(){return this.$store.state.hive.accounts["hive.fund"]}},filteredProposals:function(){var t=this,e=this.proposals;return this.proposals.length>0?(this.filterExpired&&(e=e.filter((function(t){return"expired"!==t.status}))),this.filterActive&&(e=e.filter((function(t){return"active"!==t.status}))),this.filterVoted&&(e=e.filter((function(t){return!0!==t.voted}))),this.filterFunded&&(e=e.filter((function(e){return e.total_votes<t.returnProposalVotes}))),this.filterUnfunded&&(e=e.filter((function(e){return e.total_votes>=t.returnProposalVotes}))),""!==this.search&&(e=e.filter((function(e){return e.subject.includes(t.search)||e.receiver.includes(t.search)||e.creator.includes(t.search)}))),e):[]},returnProposalVotes:function(){var t=this.proposals.find((function(t){return 0===t.id}));return t?parseInt(t.total_votes):0}},mounted:function(){document.title="Hive Proposal System",void 0!==this.daoAccount&&this.daoAccount.name===this.username||this.getAccount("hive.fund"),this.listProposals(),this.globalProps.empty&&this.$store.dispatch("hive/getGlobalProps")}},P=y,k=r("9989"),A=r("f09f"),H=r("a370"),U=r("58a8"),V=r("8f8e"),I=r("27f9"),Q=r("9c40"),C=Object(p["a"])(P,s,a,!1,null,null,null);e["default"]=C.exports;b()(C,"components",{QPage:k["a"],QCard:A["a"],QCardSection:H["a"],QList:d["a"],QItem:v["a"],QItemSection:f["a"],QBadge:U["a"],QCheckbox:V["a"],QInput:I["a"],QIcon:_["a"],QBtn:Q["a"]})}}]);