(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[41],{"821f":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{staticClass:"flex q-pa-md flex-center"},[n("exchange")],1)},r=[],o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[n("q-dialog",{staticClass:"text-bold",attrs:{persistent:""},model:{value:t.showErrorDialog,callback:function(e){t.showErrorDialog=e},expression:"showErrorDialog"}},[n("q-card",{staticClass:"q-pa-sm",attrs:{flat:"",bordered:""}},[n("q-icon",{attrs:{name:"warning",color:"orange",size:"md"}}),t._v("\n        "+t._s(t.error)+"\n        "),n("q-btn",{attrs:{label:"Dismiss","q-close-dialog":""},on:{click:function(e){t.error=null}}})],1)],1),1===t.step?n("q-card",{staticClass:"text-center",staticStyle:{"max-width":"600px"},attrs:{flat:"",bordered:""}},[1===t.step?n("q-card-section",{attrs:{header:""}},[n("div",{staticClass:"text-center text-title text-h5"},[t._v("Exchange "),t.currencies.length>0?n("q-badge",{attrs:{color:"primary"}},[t._v(t._s(t.currencies.length))]):t._e(),t._v(" tokens")],1),n("div",{staticClass:"text-caption"},[t._v("Use this form to swap between cryptocurrencies")])]):t._e(),1===t.step?n("q-card-section",[n("q-list",{attrs:{separator:""}},[n("q-item",{staticClass:"q-mb-md"},[n("q-item-section",[n("q-select",{attrs:{filled:"",label:"Send this Token",options:t.optionsFrom,clearable:"","options-selected-class":"text-primary","use-input":"","input-debounce":"0",loading:t.loading.currencies},on:{filter:t.filterFrom,input:t.updateToken},scopedSlots:t._u([t.tradeFrom?{key:"before",fn:function(){return[n("q-avatar",[n("q-img",{attrs:{src:t.getTokenImage(t.tradeFrom),title:t.tradeFrom}})],1)]},proxy:!0}:null,t.tradeFrom&&t.tradeTo?{key:"after",fn:function(){return[n("q-input",{staticClass:"q-pt-md",attrs:{label:"Amount",type:"number",rules:[function(e){return e>t.minAmount||"Minimum trade is "+t.minAmount+" "+t.tradeFrom},null!==t.error||t.error],loading:t.loading.minAmount,debounce:2e3,readonly:t.loading.minAmount,clearable:""},on:{input:function(e){return t.updateTradeFromAmount()}},model:{value:t.tradeFromAmount,callback:function(e){t.tradeFromAmount=t._n(e)},expression:"tradeFromAmount"}})]},proxy:!0}:null],null,!0),model:{value:t.tradeFrom,callback:function(e){t.tradeFrom=e},expression:"tradeFrom"}})],1)],1),t.tradeFrom||t.tradeTo?n("q-item",{staticClass:"text-center"},[n("q-btn",{attrs:{flat:"",icon:"swap_vert",size:"md",color:"primary",title:"Swap token positions"},on:{click:function(e){return t.swapTokens()}}})],1):t._e(),n("q-item",[n("q-item-section",[n("q-select",{attrs:{filled:"",label:"Receive this Token",options:t.optionsTo,clearable:"","options-selected-class":"text-primary","use-input":"","input-debounce":"0",loading:t.loading.currencies},on:{filter:t.filterTo,input:t.updateToken},scopedSlots:t._u([t.tradeTo?{key:"before",fn:function(){return[n("q-avatar",[n("q-img",{attrs:{src:t.getTokenImage(t.tradeTo),title:t.tradeTo}})],1)]},proxy:!0}:null],null,!0),model:{value:t.tradeTo,callback:function(e){t.tradeTo=e},expression:"tradeTo"}})],1),t.tradeTo&&t.tradeToAmount?n("q-item-section",{attrs:{side:""}},[n("q-input",{attrs:{label:"Amount",readonly:"",hint:"Receive ~"+t.tidyNumber(t.tradeToAmount)+" "+t.tradeTo,loading:t.loading.quote},model:{value:t.tradeToAmount,callback:function(e){t.tradeToAmount=e},expression:"tradeToAmount"}})],1):t._e()],1)],1)],1):t._e(),!t.error&&t.tradeFromAmount>t.minAmount&&t.tradeToAmount&&t.tradeFrom&&t.tradeTo?n("q-card-section",[n("div",{staticClass:"text-center text-title text-h5"},[n("q-input",{attrs:{label:"Receiving Address : "+t.tradeTo,rules:[function(t){return!!t||"Receiving address is required"},function(t){return""!==t.trim()||"Receiving address is required"}]},model:{value:t.tradeToAddress,callback:function(e){t.tradeToAddress=e},expression:"tradeToAddress"}})],1),t.quote?n("div",{staticClass:"text-center text-title text-h5"},[t._v("Trade confirmation")]):t._e(),t._v("\n      Swap "),n("q-badge",{staticClass:"text-bold",attrs:{color:"primary"}},[t._v(t._s(t.tidyNumber(t.tradeFromAmount)))]),n("q-avatar",{attrs:{size:"sm"}},[n("img",{attrs:{src:t.getTokenImage(t.tradeFrom)}})]),n("b",[t._v(t._s(t.tradeFrom))]),t._v("\n      for ~"),n("q-badge",{attrs:{color:"primary"}},[t._v(t._s(t.tidyNumber(t.tradeToAmount)))]),n("q-avatar",{attrs:{size:"sm"}},[n("img",{attrs:{src:t.getTokenImage(t.tradeTo)}})]),n("b",[t._v(t._s(t.tradeTo))]),n("br"),""!==t.tradeToAddress?n("div",[t._v("Send that "),n("q-avatar",{attrs:{size:"sm"}},[n("img",{attrs:{src:t.getTokenImage(t.tradeTo)}})]),n("b",[t._v(t._s(t.tradeTo))]),t._v(" to "),n("i",[t._v(t._s(t.tradeToAddress))])],1):t._e(),t.quote?n("q-expansion-item",{attrs:{dense:"",icon:"data_object",label:"Full quote"}},[n("json-viewer",{attrs:{data:t.quote}})],1):t._e(),n("q-separator",{attrs:{dark:""}})],1):t._e(),t.tradeFrom&&t.tradeTo?n("q-card",{staticClass:"q-pa-sm q-ma-sm",attrs:{flat:"",bordered:""}},[n("q-checkbox",{staticClass:"text-caption",model:{value:t.termsAndConditions,callback:function(e){t.termsAndConditions=e},expression:"termsAndConditions"}},[t._v("I have read and I agreed to the Changelly "),n("a",{attrs:{href:"https://changelly.com/terms-of-use",target:"_blank"}},[t._v("terms of use")]),t._v(" and "),n("a",{attrs:{href:"https://changelly.com/privacy-policy"}},[t._v("privacy policy")]),t._v("."),n("br"),t._v("By checking this box, I acknowledge and understand that my transaction may trigger AML/KYC verification according to Changelly "),n("a",{attrs:{href:"https://changelly.com/aml-kyc"}},[t._v("AML/KYC")])])],1):t._e(),n("q-card-actions",{attrs:{align:"around"}},[t.tradeFrom||t.tradeTo?n("q-btn",{attrs:{flat:"",label:"Go Back",color:"red",icon:"arrow_back"},on:{click:function(e){return t.reset()}}}):t._e(),t.tradeFrom||t.tradeTo?n("q-btn",{attrs:{flat:"",label:"Continue",color:"primary","icon-right":"arrow_forward",disable:!t.termsAndConditions||null!==t.error||null===t.tradeToAddress||""===t.tradeToAddress.trim()},on:{click:function(e){t.createTransaction(t.tradeFrom,t.tradeTo,t.tradeToAddress,t.tradeFromAmount)}}}):t._e()],1)],1):t._e(),t.transaction?n("q-dialog",{attrs:{persistent:""},model:{value:t.showTransactionDialog,callback:function(e){t.showTransactionDialog=e},expression:"showTransactionDialog"}},[n("q-card",{attrs:{flat:"",bordered:""}},[n("q-card-section",{staticClass:"text-heading text-h5 text-center",attrs:{header:""}},[t._v("\n          Payment Request\n      ")]),n("q-card-section",[t._v("\n          Please transfer:\n          "),n("q-input",{attrs:{readonly:""},scopedSlots:t._u([{key:"append",fn:function(){return[n("q-btn",{attrs:{flat:"",icon:"content_copy"},on:{click:function(e){return t.copy(t.transaction.amountExpectedFrom)}}})]},proxy:!0},{key:"after",fn:function(){return[n("q-avatar",[n("q-img",{attrs:{src:t.getTokenImage(t.transaction.currencyFrom)}})],1),t._v(" "+t._s(t.transaction.currencyFrom))]},proxy:!0}],null,!1,3755824813),model:{value:t.transaction.amountExpectedFrom,callback:function(e){t.$set(t.transaction,"amountExpectedFrom",e)},expression:"transaction.amountExpectedFrom"}}),t._v("\n          To this "+t._s(t.transaction.currencyFrom)+" address:\n          "),n("q-input",{attrs:{readonly:""},scopedSlots:t._u([{key:"after",fn:function(){return[n("q-btn",{attrs:{flat:"",icon:"content_copy"},on:{click:function(e){return t.copy(t.transaction.payinAddress)}}})]},proxy:!0}],null,!1,3321282976),model:{value:t.transaction.payinAddress,callback:function(e){t.$set(t.transaction,"payinAddress",e)},expression:"transaction.payinAddress"}}),t.transaction.payinExtraId?n("div",[n("q-input",{attrs:{label:"Payment Address Extra ID / MEMO"},scopedSlots:t._u([{key:"append",fn:function(){return[n("q-btn",{attrs:{flat:"",icon:"content_copy"},on:{click:function(e){return t.copy(t.transaction.amountExpectedFrom)}}})]},proxy:!0}],null,!1,1514316407),model:{value:t.transaction.payinExtraId,callback:function(e){t.$set(t.transaction,"payinExtraId",e)},expression:"transaction.payinExtraId"}})],1):t._e()],1),n("q-separator"),t.loggedInUser&&"hive"===t.transaction.currencyFrom?n("q-card-section",{staticClass:"text-center text-bold"},[t._v("\n        "+t._s(t.loggedInUser)+"'s balance "),n("q-badge",{attrs:{color:"primary"}},[t._v(t._s(t.account.balance.split(" ")[0]))]),n("q-avatar",{attrs:{size:"sm"}},[n("q-img",{attrs:{src:"/statics/hive.svg",title:"HIVE"}})],1),n("q-btn",{attrs:{push:"",icon:"send","no-caps":"",color:"primary",disable:"waiting"!==t.transaction.status||t.transaction.moneyReceived>0||parseFloat(t.account.balance.split(" ")[0])<t.transaction.amountExpectedFrom||t.disableTransferButton},on:{click:function(e){return t.transferNeededHive()}}},[t._v("Transfer "+t._s(t.transaction.amountExpectedFrom)+" HIVE to "+t._s(t.transaction.payinAddress)+" with memo "+t._s(t.transaction.payinExtraId))])],1):t._e(),t.loggedInUser&&"hive"===t.tradeFrom?n("q-separator"):t._e(),n("q-card-section",[n("q-input",{attrs:{readonly:"",label:"Exchange Id (For support purposes)"},scopedSlots:t._u([{key:"after",fn:function(){return[n("q-btn",{attrs:{flat:"",icon:"content_copy"},on:{click:function(e){return t.copy(t.transaction.id)}}}),n("q-btn",{attrs:{flat:"",icon:"open_in_new",title:"Open exchange status in new window"},on:{click:function(e){t.openNewWindow(t.getExchangeIdUrl(t.transaction.id))}}})]},proxy:!0}],null,!1,3864658042),model:{value:t.transaction.id,callback:function(e){t.$set(t.transaction,"id",e)},expression:"transaction.id"}}),n("q-input",{attrs:{readonly:"",label:"Exchange Status"},scopedSlots:t._u([{key:"after",fn:function(){return[n("q-btn",{attrs:{flat:"",icon:"refresh",label:"Refresh Status",color:"primary"},on:{click:function(e){return t.getStatus(t.transaction.id)}}})]},proxy:!0}],null,!1,554818371),model:{value:t.transaction.status,callback:function(e){t.$set(t.transaction,"status",e)},expression:"transaction.status"}}),n("span",{staticClass:"q-ma-sm text-bold text-title text-center"},["waiting"===t.transaction.status?n("q-card",{attrs:{flat:"",bordered:""}},[t._v("Transaction is waiting for an incoming payment.")]):t._e(),"confirming"===t.transaction.status?n("q-card",{attrs:{flat:"",bordered:""}},[t._v("We have received payin and are waiting for certain amount of confirmations depending of incoming currency.")]):t._e(),"exchanging"===t.transaction.status?n("q-card",{attrs:{flat:"",bordered:""}},[t._v("Payment was confirmed and is being exchanged.")]):t._e(),"sending"===t.transaction.status?n("q-card",{attrs:{flat:"",bordered:""}},[t._v("Coins are being sent to the recipient address.")]):t._e(),"finished"===t.transaction.status?n("q-card",{attrs:{flat:"",bordered:""}},[t._v("Coins were successfully sent to the recipient address.")]):t._e(),"failed"===t.transaction.status?n("q-card",{attrs:{flat:"",bordered:""}},[t._v("Transaction has failed. In most cases, the amount was less than the minimum. Please contact support and provide a transaction id.")]):t._e(),"refunded"===t.transaction.status?n("q-card",{attrs:{flat:"",bordered:""}},[t._v("Exchange failed and coins were refunded to user's wallet. The wallet address should be provided by user.")]):t._e(),"hold"===t.transaction.status?n("q-card",{attrs:{flat:"",bordered:""}},[t._v("Due to AML/KYC procedure, exchange may be delayed")]):t._e(),"expired"===t.transaction.status?n("q-card",{attrs:{flat:"",bordered:""}},[t._v("In case payin for fixed-rate transaction was not sent within the indicated timeframe")]):t._e()],1)],1),n("q-card-section",[n("q-expansion-item",{attrs:{dense:"",label:"Full Transaction Metadata",icon:"data_object"}},[n("json-viewer",{attrs:{data:t.transaction}})],1)],1),n("q-card-section",[n("q-input",{attrs:{label:"Payout Address",readonly:""},scopedSlots:t._u([{key:"after",fn:function(){return[t._v("\n            "+t._s(t.transaction.currencyTo)+" "),n("q-avatar",[n("q-img",{attrs:{src:t.getTokenImage(t.transaction.currencyTo),title:t.transaction.currencyTo}})],1)]},proxy:!0}],null,!1,1469457642),model:{value:t.transaction.payoutAddress,callback:function(e){t.$set(t.transaction,"payoutAddress",e)},expression:"transaction.payoutAddress"}})],1),n("q-card-actions",{attrs:{align:"around"}},[n("q-btn",{attrs:{flat:"",label:"Exit/Abort",color:"red",icon:"warning"},on:{click:function(e){t.transaction=null}}})],1)],1)],1):t._e()],1)},s=[],i=(n("d25f"),n("28a5"),n("06db"),n("6b54"),n("a481"),n("cdde")),c={name:"exchange",data:function(){return{api:"https://exchange-api.ausbit.dev",tradeFrom:this.$route.query.from||null,tradeTo:this.$route.query.to||"hive",tradeFromAmount:null,tradeToAmount:null,tradeToAddress:this.$route.query.address||null,optionsFrom:[],optionsTo:[],currencies:[],minAmount:null,quote:null,termsAndConditions:!1,loading:{minAmount:!1,quote:!1,currencies:!1,transaction:!1},transaction:null,error:null,step:1,exchangeId:this.$route.query.id||null,disableTransferButton:!1}},components:{jsonViewer:function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"a00c"))}},methods:{getCurrencies:function(){var t=this;this.loading.currencies=!0,this.$axios.get(this.api+"/getCurrencies").then((function(e){t.currencies=e.data.result.sort(),t.loading.currencies=!1}))},getMinAmount:function(t,e){var n=this;this.minAmount=null,this.loading.minAmount=!0,this.tradeToAmount=null,this.$axios.post(this.api+"/getMinAmount",{from:t,to:e}).then((function(t){n.minAmount=t.data.result,n.tradeFromAmount=n.minAmount,n.getExchangeAmount(n.tradeFrom,n.tradeTo,n.tradeFromAmount),n.loading.minAmount=!1}))},filterFrom:function(t,e){var n=this;e(""!==t?function(){var e=t.toLowerCase();n.optionsFrom=n.currencies.filter((function(t){return t.toLowerCase().indexOf(e)>-1})).filter((function(t){return t!==n.tradeTo}))}:function(){n.optionsFrom=n.currencies.filter((function(t){return t!==n.tradeTo}))})},filterTo:function(t,e){var n=this;e(""!==t?function(){var e=t.toLowerCase();n.optionsTo=n.currencies.filter((function(t){return t.toLowerCase().indexOf(e)>-1})).filter((function(t){return t!==n.tradeFrom}))}:function(){n.optionsTo=n.currencies.filter((function(t){return t!==n.tradeFrom}))})},reset:function(){this.tradeFrom=null,this.tradeTo=null,this.minAmount=null,this.tradeFromAmount=null,this.tradeToAmount=null,this.quote=null,this.termsAndConditions=!1,this.step=1},getTokenImage:function(t){return"https://web-api.changelly.com/api/coins/"+t+".png"},getExchangeAmount:function(t,e,n){var a=this;this.loading.quote=!0,this.tradeToAmount=null,this.$axios.post(this.api+"/getExchangeAmount",{from:t,to:e,amount:n}).then((function(t){t.data.error?a.error=t.data.error.message:(a.quote=t.data.result[0],a.tradeToAmount=a.quote.result),a.loading.quote=!1}))},createTransaction:function(t,e,n,a){var r=this;this.transaction=null,this.loading.transaction=!0,this.$axios.post(this.api+"/createTransaction",{from:t,to:e,address:n,amount:a}).then((function(t){t.data.error?(r.error=t.data.error.message,"Invalid address"===r.error&&(r.tradeToAddress="")):r.transaction=t.data.result,r.loading.transaction=!1}))},getStatus:function(t){var e=this;this.$axios.post(this.api+"/getStatus",{id:t}).then((function(t){t.data.error?e.error=t.data.error.message:e.transaction.status=t.data.result}))},getTransaction:function(t){var e=this;this.$axios.post(this.api+"/getTransaction",{id:t}).then((function(t){console.log(t.data),t.data.error?e.error=t.data.error.message:e.transaction=t.data.result[0]}))},updateToken:function(){this.error=null,this.$route.query.to===this.tradeTo&&this.$route.query.address?this.tradeToAddress=this.$route.query.address:this.tradeToAddress=null,this.tradeToAmount=null,this.tradeFrom&&this.tradeTo&&this.tradeFrom!==this.tradeTo&&(this.tradeFromAmount=0,this.minAmount=null,this.getMinAmount(this.tradeFrom,this.tradeTo))},updateTradeFromAmount:function(){this.error=null,this.tradeFromAmount>this.minAmount&&this.getExchangeAmount(this.tradeFrom,this.tradeTo,this.tradeFromAmount)},tidyNumber:function(t){if(t){var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")}return null},swapTokens:function(){var t=this.tradeFrom;this.tradeFrom=this.tradeTo,this.tradeTo=t,this.updateToken()},copy:function(t){Object(i["a"])(t),this.$q.notify("Copied to clipboard: "+t)},getExchangeIdUrl:function(t){return"https://hive.ausbit.dev/exchange?id="+t},openNewWindow:function(t){window.open(t,"_blank")},transferNeededHive:function(){this.$store.commit("hive/addToQueue",[this.loggedInUser,"active",["transfer",{to:this.transaction.payinAddress,from:this.loggedInUser,amount:this.transaction.amountExpectedFrom+" HIVE",memo:this.transaction.payinExtraId}]]),this.disableTransferButton=!0}},computed:{loggedInUser:function(){return this.$store.state.hive.user.username},showTransactionDialog:function(){return null!==this.transaction},showErrorDialog:function(){return null!==this.error},account:{cache:!1,get:function(){return this.loggedInUser?this.$store.state.hive.accounts[this.loggedInUser]:null}}},watch:{loggedInUser:function(){null===this.account&&this.loggedInUser&&this.$store.dispatch("hive/getAccount",this.loggedInUser)}},mounted:function(){this.getCurrencies(),this.exchangeId&&this.getTransaction(this.exchangeId),this.tradeFrom&&this.tradeTo&&this.updateToken(),null===this.account&&this.loggedInUser&&this.$store.dispatch("hive/getAccount",this.loggedInUser)}},d=c,u=n("2877"),l=n("24e8"),m=n("f09f"),h=n("0016"),p=n("9c40"),f=n("a370"),g=n("58a8"),b=n("1c1c"),q=n("66e5"),v=n("4074"),y=n("ddd8"),x=n("cb32"),_=n("068f"),T=n("27f9"),A=n("3b73"),k=n("eb85"),F=n("8f8e"),w=n("4b7e"),I=n("eebe"),C=n.n(I),E=Object(u["a"])(d,o,s,!1,null,null,null),$=E.exports;C()(E,"components",{QDialog:l["a"],QCard:m["a"],QIcon:h["a"],QBtn:p["a"],QCardSection:f["a"],QBadge:g["a"],QList:b["a"],QItem:q["a"],QItemSection:v["a"],QSelect:y["a"],QAvatar:x["a"],QImg:_["a"],QInput:T["a"],QExpansionItem:A["a"],QSeparator:k["a"],QCheckbox:F["a"],QCardActions:w["a"]});var S={name:"exchangePage",components:{exchange:$},data:function(){return{fromDefault:this.$route.query.fromDefault,toDefault:this.$route.query.toDefault,from:this.$route.query.from,memo:this.$route.query.memo,to:this.$route.query.to,defaultAmount:this.$route.query.defaultAmount,address:this.$route.query.address}},watch:{},computed:{},methods:{},mounted:function(){}},Q=S,D=n("9989"),U=Object(u["a"])(Q,a,r,!1,null,null,null);e["default"]=U.exports;C()(U,"components",{QPage:D["a"]})}}]);