(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[41],{"821f":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"flex q-pa-md flex-center"},[a("exchange")],1)},n=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[a("q-dialog",{staticClass:"text-bold",attrs:{persistent:""},model:{value:t.showErrorDialog,callback:function(e){t.showErrorDialog=e},expression:"showErrorDialog"}},[a("q-card",{staticClass:"q-pa-sm",attrs:{flat:"",bordered:""}},[a("q-icon",{attrs:{name:"warning",color:"orange",size:"md"}}),t._v("\n        "+t._s(t.error)+"\n        "),a("q-btn",{attrs:{label:"Dismiss","q-close-dialog":""},on:{click:function(e){t.error=null}}})],1)],1),1===t.step?a("q-card",{staticClass:"text-center",staticStyle:{"max-width":"600px"},attrs:{flat:"",bordered:""}},[1===t.step?a("q-card-section",{attrs:{header:""}},[a("div",{staticClass:"text-center text-title text-h5"},[t._v("Exchange "),t.currencies.length>0?a("q-badge",{attrs:{color:"primary"}},[t._v(t._s(t.currencies.length))]):t._e(),t._v(" tokens")],1),a("div",{staticClass:"text-caption"},[t._v("Use this form to swap between cryptocurrencies")])]):t._e(),1===t.step?a("q-card-section",[a("q-list",{attrs:{separator:""}},[a("q-item",{staticClass:"q-mb-md"},[a("q-item-section",[a("q-select",{attrs:{filled:"",label:"Send this Token",options:t.optionsFrom,clearable:"","options-selected-class":"text-primary","use-input":"","input-debounce":"0",loading:t.loading.currencies},on:{filter:t.filterFrom,input:t.updateToken},scopedSlots:t._u([t.tradeFrom?{key:"before",fn:function(){return[a("q-avatar",[a("q-img",{attrs:{src:t.getTokenImage(t.tradeFrom),title:t.tradeFrom}})],1)]},proxy:!0}:null,t.tradeFrom&&t.tradeTo?{key:"after",fn:function(){return[a("q-input",{staticClass:"q-pt-md",attrs:{label:"Amount",type:"number",rules:[function(e){return e>t.minAmount||"Minimum trade is "+t.minAmount+" "+t.tradeFrom},null!==t.error||t.error],loading:t.loading.minAmount,debounce:2e3,readonly:t.loading.minAmount,clearable:""},on:{input:function(e){return t.updateTradeFromAmount()}},model:{value:t.tradeFromAmount,callback:function(e){t.tradeFromAmount=t._n(e)},expression:"tradeFromAmount"}})]},proxy:!0}:null],null,!0),model:{value:t.tradeFrom,callback:function(e){t.tradeFrom=e},expression:"tradeFrom"}})],1)],1),t.tradeFrom||t.tradeTo?a("q-item",{staticClass:"text-center"},[a("q-btn",{attrs:{flat:"",icon:"swap_vert",size:"md",color:"primary",title:"Swap token positions"},on:{click:function(e){return t.swapTokens()}}})],1):t._e(),a("q-item",[a("q-item-section",[a("q-select",{attrs:{filled:"",label:"Receive this Token",options:t.optionsTo,clearable:"","options-selected-class":"text-primary","use-input":"","input-debounce":"0",loading:t.loading.currencies},on:{filter:t.filterTo,input:t.updateToken},scopedSlots:t._u([t.tradeTo?{key:"before",fn:function(){return[a("q-avatar",[a("q-img",{attrs:{src:t.getTokenImage(t.tradeTo),title:t.tradeTo}})],1)]},proxy:!0}:null],null,!0),model:{value:t.tradeTo,callback:function(e){t.tradeTo=e},expression:"tradeTo"}})],1),t.tradeTo&&t.tradeToAmount?a("q-item-section",{attrs:{side:""}},[a("q-input",{attrs:{label:"Amount",readonly:"",hint:"Receive ~"+t.tidyNumber(t.tradeToAmount)+" "+t.tradeTo,loading:t.loading.quote},model:{value:t.tradeToAmount,callback:function(e){t.tradeToAmount=e},expression:"tradeToAmount"}})],1):t._e()],1)],1)],1):t._e(),!t.error&&t.tradeFromAmount>t.minAmount&&t.tradeToAmount&&t.tradeFrom&&t.tradeTo?a("q-card-section",[a("div",{staticClass:"text-center text-title text-h5"},[a("q-input",{attrs:{label:"Receiving Address : "+t.tradeTo,rules:[function(t){return!!t||"Receiving address is required"},function(t){return""!==t.trim()||"Receiving address is required"}]},model:{value:t.tradeToAddress,callback:function(e){t.tradeToAddress=e},expression:"tradeToAddress"}})],1),t.quote?a("div",{staticClass:"text-center text-title text-h5"},[t._v("Trade confirmation")]):t._e(),t._v("\n      Swap "),a("q-badge",{staticClass:"text-bold",attrs:{color:"primary"}},[t._v(t._s(t.tidyNumber(t.tradeFromAmount)))]),a("q-avatar",{attrs:{size:"sm"}},[a("img",{attrs:{src:t.getTokenImage(t.tradeFrom)}})]),a("b",[t._v(t._s(t.tradeFrom))]),t._v("\n      for ~"),a("q-badge",{attrs:{color:"primary"}},[t._v(t._s(t.tidyNumber(t.tradeToAmount)))]),a("q-avatar",{attrs:{size:"sm"}},[a("img",{attrs:{src:t.getTokenImage(t.tradeTo)}})]),a("b",[t._v(t._s(t.tradeTo))]),a("br"),""!==t.tradeToAddress?a("div",[t._v("Send that "),a("q-avatar",{attrs:{size:"sm"}},[a("img",{attrs:{src:t.getTokenImage(t.tradeTo)}})]),a("b",[t._v(t._s(t.tradeTo))]),t._v(" to "),a("i",[t._v(t._s(t.tradeToAddress))])],1):t._e(),t.quote?a("q-expansion-item",{attrs:{dense:"",icon:"data_object",label:"Full quote"}},[a("json-viewer",{attrs:{data:t.quote}})],1):t._e(),a("q-separator",{attrs:{dark:""}})],1):t._e(),t.tradeFrom&&t.tradeTo?a("q-card",{staticClass:"q-pa-sm q-ma-sm",attrs:{flat:"",bordered:""}},[a("q-checkbox",{staticClass:"text-caption",model:{value:t.termsAndConditions,callback:function(e){t.termsAndConditions=e},expression:"termsAndConditions"}},[t._v("I have read and I agreed to the Changelly "),a("a",{attrs:{href:"https://changelly.com/terms-of-use",target:"_blank"}},[t._v("terms of use")]),t._v(" and "),a("a",{attrs:{href:"https://changelly.com/privacy-policy"}},[t._v("privacy policy")]),t._v("."),a("br"),t._v("By checking this box, I acknowledge and understand that my transaction may trigger AML/KYC verification according to Changelly "),a("a",{attrs:{href:"https://changelly.com/aml-kyc"}},[t._v("AML/KYC")])])],1):t._e(),a("q-card-actions",{attrs:{align:"around"}},[t.tradeFrom||t.tradeTo?a("q-btn",{attrs:{flat:"",label:"Go Back",color:"red",icon:"arrow_back"},on:{click:function(e){return t.reset()}}}):t._e(),t.tradeFrom||t.tradeTo?a("q-btn",{attrs:{flat:"",label:"Continue",color:"primary","icon-right":"arrow_forward",disable:!t.termsAndConditions||null!==t.error||null===t.tradeToAddress||""===t.tradeToAddress.trim()},on:{click:function(e){t.createTransaction(t.tradeFrom,t.tradeTo,t.tradeToAddress,t.tradeFromAmount)}}}):t._e()],1)],1):t._e(),t.transaction?a("q-dialog",{attrs:{persistent:""},model:{value:t.showTransactionDialog,callback:function(e){t.showTransactionDialog=e},expression:"showTransactionDialog"}},[a("q-card",{attrs:{flat:"",bordered:""}},[a("q-card-section",{staticClass:"text-heading text-h5 text-center",attrs:{header:""}},[t._v("\n          Payment Request\n      ")]),a("q-card-section",[t._v("\n          Please transfer:\n          "),a("q-input",{attrs:{readonly:""},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-btn",{attrs:{flat:"",icon:"content_copy"},on:{click:function(e){return t.copy(t.transaction.amountExpectedFrom)}}})]},proxy:!0},{key:"after",fn:function(){return[a("q-avatar",[a("q-img",{attrs:{src:t.getTokenImage(t.transaction.currencyFrom)}})],1),t._v(" "+t._s(t.transaction.currencyFrom))]},proxy:!0}],null,!1,3755824813),model:{value:t.transaction.amountExpectedFrom,callback:function(e){t.$set(t.transaction,"amountExpectedFrom",e)},expression:"transaction.amountExpectedFrom"}}),t._v("\n          To this "+t._s(t.transaction.currencyFrom)+" address:\n          "),a("q-input",{attrs:{readonly:""},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{flat:"",icon:"content_copy"},on:{click:function(e){return t.copy(t.transaction.payinAddress)}}})]},proxy:!0}],null,!1,3321282976),model:{value:t.transaction.payinAddress,callback:function(e){t.$set(t.transaction,"payinAddress",e)},expression:"transaction.payinAddress"}}),t.transaction.payinExtraId?a("div",[a("q-input",{attrs:{label:"Payment Address Extra ID / MEMO"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-btn",{attrs:{flat:"",icon:"content_copy"},on:{click:function(e){return t.copy(t.transaction.amountExpectedFrom)}}})]},proxy:!0}],null,!1,1514316407),model:{value:t.transaction.payinExtraId,callback:function(e){t.$set(t.transaction,"payinExtraId",e)},expression:"transaction.payinExtraId"}})],1):t._e()],1),a("q-separator"),a("q-card-section",[a("q-input",{attrs:{readonly:"",label:"Exchange Id (For support purposes)"},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{flat:"",icon:"content_copy"},on:{click:function(e){return t.copy(t.transaction.id)}}}),a("a",{attrs:{href:t.getExchangeIdUrl(t.transaction.id),target:"_blank"}},[a("q-icon",{attrs:{name:"open_in_new"}})],1)]},proxy:!0}],null,!1,1336440055),model:{value:t.transaction.id,callback:function(e){t.$set(t.transaction,"id",e)},expression:"transaction.id"}}),a("q-input",{attrs:{readonly:"",label:"Exchange Status"},scopedSlots:t._u([{key:"after",fn:function(){return[a("q-btn",{attrs:{flat:"",icon:"refresh",label:"Refresh Status",color:"primary"},on:{click:function(e){return t.getStatus(t.transaction.id)}}})]},proxy:!0}],null,!1,554818371),model:{value:t.transaction.status,callback:function(e){t.$set(t.transaction,"status",e)},expression:"transaction.status"}}),a("span",{staticClass:"q-ma-sm text-bold text-title text-center"},["waiting"===t.transaction.status?a("q-card",{attrs:{flat:"",bordered:""}},[t._v("Transaction is waiting for an incoming payment.")]):t._e(),"confirming"===t.transaction.status?a("q-card",{attrs:{flat:"",bordered:""}},[t._v("We have received payin and are waiting for certain amount of confirmations depending of incoming currency.")]):t._e(),"exchanging"===t.transaction.status?a("q-card",{attrs:{flat:"",bordered:""}},[t._v("Payment was confirmed and is being exchanged.")]):t._e(),"sending"===t.transaction.status?a("q-card",{attrs:{flat:"",bordered:""}},[t._v("Coins are being sent to the recipient address.")]):t._e(),"finished"===t.transaction.status?a("q-card",{attrs:{flat:"",bordered:""}},[t._v("Coins were successfully sent to the recipient address.")]):t._e(),"failed"===t.transaction.status?a("q-card",{attrs:{flat:"",bordered:""}},[t._v("Transaction has failed. In most cases, the amount was less than the minimum. Please contact support and provide a transaction id.")]):t._e(),"refunded"===t.transaction.status?a("q-card",{attrs:{flat:"",bordered:""}},[t._v("Exchange failed and coins were refunded to user's wallet. The wallet address should be provided by user.")]):t._e(),"hold"===t.transaction.status?a("q-card",{attrs:{flat:"",bordered:""}},[t._v("Due to AML/KYC procedure, exchange may be delayed")]):t._e(),"expired"===t.transaction.status?a("q-card",{attrs:{flat:"",bordered:""}},[t._v("In case payin for fixed-rate transaction was not sent within the indicated timeframe")]):t._e()],1)],1),a("q-card-section",[a("q-expansion-item",{attrs:{dense:"",label:"Full Transaction Metadata",icon:"data_object"}},[a("json-viewer",{attrs:{data:t.transaction}})],1)],1),a("q-card-section",[a("q-input",{attrs:{label:"Payout Address",readonly:""},scopedSlots:t._u([{key:"after",fn:function(){return[t._v("\n            "+t._s(t.transaction.currencyTo)+" "),a("q-avatar",[a("q-img",{attrs:{src:t.getTokenImage(t.transaction.currencyTo),title:t.transaction.currencyTo}})],1)]},proxy:!0}],null,!1,1469457642),model:{value:t.transaction.payoutAddress,callback:function(e){t.$set(t.transaction,"payoutAddress",e)},expression:"transaction.payoutAddress"}})],1),a("q-card-actions",{attrs:{align:"around"}},[a("q-btn",{attrs:{flat:"",label:"Exit/Abort",color:"red",icon:"warning"},on:{click:function(e){t.transaction=null}}})],1)],1)],1):t._e()],1)},s=[],i=(a("d25f"),a("28a5"),a("06db"),a("6b54"),a("a481"),a("cdde")),c={name:"exchange",data:function(){return{api:"https://exchange-api.ausbit.dev",tradeFrom:null,tradeTo:this.$route.query.to||"hive",tradeFromAmount:null,tradeToAmount:null,tradeToAddress:this.$route.query.address||null,optionsFrom:[],optionsTo:[],currencies:[],minAmount:null,quote:null,termsAndConditions:!1,loading:{minAmount:!1,quote:!1,currencies:!1,transaction:!1},transaction:null,error:null,step:1,exchangeId:this.$route.query.id||null}},components:{jsonViewer:function(){return Promise.all([a.e(0),a.e(1)]).then(a.bind(null,"a00c"))}},methods:{getCurrencies:function(){var t=this;this.loading.currencies=!0,this.$axios.get(this.api+"/getCurrencies").then((function(e){t.currencies=e.data.result.sort(),t.loading.currencies=!1}))},getMinAmount:function(t,e){var a=this;this.minAmount=null,this.loading.minAmount=!0,this.tradeToAmount=null,this.$axios.post(this.api+"/getMinAmount",{from:t,to:e}).then((function(t){a.minAmount=t.data.result,a.tradeFromAmount=a.minAmount,a.getExchangeAmount(a.tradeFrom,a.tradeTo,a.tradeFromAmount),a.loading.minAmount=!1}))},filterFrom:function(t,e){var a=this;e(""!==t?function(){var e=t.toLowerCase();a.optionsFrom=a.currencies.filter((function(t){return t.toLowerCase().indexOf(e)>-1})).filter((function(t){return t!==a.tradeTo}))}:function(){a.optionsFrom=a.currencies.filter((function(t){return t!==a.tradeTo}))})},filterTo:function(t,e){var a=this;e(""!==t?function(){var e=t.toLowerCase();a.optionsTo=a.currencies.filter((function(t){return t.toLowerCase().indexOf(e)>-1})).filter((function(t){return t!==a.tradeFrom}))}:function(){a.optionsTo=a.currencies.filter((function(t){return t!==a.tradeFrom}))})},reset:function(){this.tradeFrom=null,this.tradeTo=null,this.minAmount=null,this.tradeFromAmount=null,this.tradeToAmount=null,this.quote=null,this.termsAndConditions=!1,this.step=1},getTokenImage:function(t){return"https://web-api.changelly.com/api/coins/"+t+".png"},getExchangeAmount:function(t,e,a){var r=this;this.loading.quote=!0,this.tradeToAmount=null,this.$axios.post(this.api+"/getExchangeAmount",{from:t,to:e,amount:a}).then((function(t){t.data.error?r.error=t.data.error.message:(r.quote=t.data.result[0],r.tradeToAmount=r.quote.result),r.loading.quote=!1}))},createTransaction:function(t,e,a,r){var n=this;this.transaction=null,this.loading.transaction=!0,this.$axios.post(this.api+"/createTransaction",{from:t,to:e,address:a,amount:r}).then((function(t){t.data.error?(n.error=t.data.error.message,"Invalid address"===n.error&&(n.tradeToAddress="")):n.transaction=t.data.result,n.loading.transaction=!1}))},getStatus:function(t){var e=this;this.$axios.post(this.api+"/getStatus",{id:t}).then((function(t){t.data.error?e.error=t.data.error.message:e.transaction.status=t.data.result}))},getTransaction:function(t){var e=this;this.$axios.post(this.api+"/getTransaction",{id:t}).then((function(t){console.log(t.data),t.data.error?e.error=t.data.error.message:e.transaction=t.data.result[0]}))},updateToken:function(){this.error=null,this.$route.query.to===this.tradeTo&&this.$route.query.address?this.tradeToAddress=this.$route.query.address:this.tradeToAddress=null,this.tradeToAmount=null,this.tradeFrom&&this.tradeTo&&this.tradeFrom!==this.tradeTo&&(this.tradeFromAmount=0,this.minAmount=null,this.getMinAmount(this.tradeFrom,this.tradeTo))},updateTradeFromAmount:function(){this.error=null,this.tradeFromAmount>this.minAmount&&this.getExchangeAmount(this.tradeFrom,this.tradeTo,this.tradeFromAmount)},tidyNumber:function(t){if(t){var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")}return null},swapTokens:function(){var t=this.tradeFrom;this.tradeFrom=this.tradeTo,this.tradeTo=t,this.updateToken()},copy:function(t){Object(i["a"])(t),this.$q.notify("Copied to clipboard: "+t)},getExchangeIdUrl:function(t){return"https://hive.ausbit.dev/exchange?id="+t}},computed:{loggedInUser:function(){return this.$store.state.hive.user.username},showTransactionDialog:function(){return null!==this.transaction},showErrorDialog:function(){return null!==this.error}},mounted:function(){this.getCurrencies(),this.exchangeId&&this.getTransaction(this.exchangeId)}},d=c,u=a("2877"),l=a("24e8"),m=a("f09f"),p=a("0016"),f=a("9c40"),h=a("a370"),g=a("58a8"),q=a("1c1c"),b=a("66e5"),y=a("4074"),v=a("ddd8"),x=a("cb32"),T=a("068f"),_=a("27f9"),A=a("3b73"),k=a("eb85"),F=a("8f8e"),w=a("4b7e"),C=a("eebe"),I=a.n(C),E=Object(u["a"])(d,o,s,!1,null,null,null),$=E.exports;I()(E,"components",{QDialog:l["a"],QCard:m["a"],QIcon:p["a"],QBtn:f["a"],QCardSection:h["a"],QBadge:g["a"],QList:q["a"],QItem:b["a"],QItemSection:y["a"],QSelect:v["a"],QAvatar:x["a"],QImg:T["a"],QInput:_["a"],QExpansionItem:A["a"],QSeparator:k["a"],QCheckbox:F["a"],QCardActions:w["a"]});var S={name:"exchangePage",components:{exchange:$},data:function(){return{fromDefault:this.$route.query.fromDefault,toDefault:this.$route.query.toDefault,from:this.$route.query.from,memo:this.$route.query.memo,to:this.$route.query.to,defaultAmount:this.$route.query.defaultAmount,address:this.$route.query.address}},watch:{},computed:{},methods:{},mounted:function(){}},Q=S,D=a("9989"),M=Object(u["a"])(Q,r,n,!1,null,null,null);e["default"]=M.exports;I()(M,"components",{QPage:D["a"]})}}]);